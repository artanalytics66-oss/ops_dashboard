<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ú–æ–Ω–∏—Ç–æ—Ä –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞ v7.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #f8fafc; font-family: system-ui, -apple-system, sans-serif; color: #334155; }
        .input-block label { display: block; font-size: 0.7rem; font-weight: 700; color: #64748b; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.05em; }
        .input-block input { width: 100%; padding: 8px 12px; border: 1px solid #e2e8f0; border-radius: 6px; font-weight: 600; font-size: 0.95rem; transition: 0.2s; background: #fff; }
        .input-block input:focus { border-color: #3b82f6; outline: none; box-shadow: 0 0 0 3px rgba(59,130,246,0.1); }
        .card { background: white; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); border: 1px solid #f1f5f9; padding: 24px; }
        .badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 700; text-transform: uppercase; }
        
        /* –¢–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫–∞ */
        h2 { font-size: 1.25rem; font-weight: 700; color: #0f172a; margin-bottom: 1rem; }
        .big-num { font-size: 1.8rem; font-weight: 800; line-height: 1.1; }
        .sub-text { font-size: 0.8rem; color: #94a3b8; font-weight: 500; margin-top: 4px; }
    </style>
</head>
<body class="p-6 max-w-7xl mx-auto min-h-screen">

    <header class="flex flex-col md:flex-row justify-between items-end mb-8 pb-6 border-b border-slate-200">
        <div>
            <h1 class="text-3xl font-extrabold text-slate-800 tracking-tight">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ú–æ–Ω–∏—Ç–æ—Ä</h1>
            <p class="text-slate-500 font-medium">–ê–Ω–∞–ª–∏–∑ —Å–º–µ–Ω—ã: –£–ø—É—â–µ–Ω–Ω–∞—è –í—ã–≥–æ–¥–∞ vs –ü—Ä—è–º—ã–µ –£–±—ã—Ç–∫–∏</p>
        </div>
        <div class="text-right mt-4 md:mt-0">
            <label class="text-xs font-bold text-slate-400 uppercase">–î–∞—Ç–∞ —Å–º–µ–Ω—ã</label>
            <div class="text-xl font-bold text-slate-700">04.01.2026</div>
        </div>
    </header>

    <div class="grid grid-cols-1 xl:grid-cols-12 gap-8">
        
        <!-- –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨: –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö (–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –±–ª–æ–∫) -->
        <div class="xl:col-span-4 space-y-6">
            
            <!-- –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
            <div class="card bg-slate-50 border-slate-200">
                <div class="flex items-center gap-2 mb-4 text-slate-500 text-sm font-bold uppercase">
                    <span class="w-2 h-2 rounded-full bg-slate-400"></span> –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="input-block">
                        <label>–¶–µ–Ω–∞ –∫–æ—Ä–æ–±–∫–∏ (–í—ã—Ä—É—á–∫–∞)</label>
                        <input type="number" id="price" value="2500" oninput="calc()">
                    </div>
                    <div class="input-block">
                        <label>–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –ª–æ–≥–∏—Å—Ç–∏–∫–∏ (1 –∫–æ—Ä)</label>
                        <input type="number" id="costLog" value="300" oninput="calc()" class="text-orange-600">
                    </div>
                </div>
            </div>

            <!-- –í–≤–æ–¥ –§–∞–∫—Ç–æ–≤ (–í–æ—Ä–æ–Ω–∫–∞) -->
            <div class="card border-l-4 border-blue-500">
                <h2 class="flex items-center justify-between">
                    –í–≤–æ–¥ –∏—Ç–æ–≥–æ–≤ (–ö–æ—Ä–æ–±–∫–∏)
                    <span class="text-xs font-normal text-slate-400 bg-slate-100 px-2 py-1 rounded">–î–∞–Ω–Ω—ã–µ 1–°</span>
                </h2>
                
                <div class="space-y-5">
                    <!-- –ü–õ–ê–ù -->
                    <div class="input-block">
                        <label class="text-blue-600">1. –ü–ª–∞–Ω (–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤)</label>
                        <input type="number" id="inPlan" value="1000" class="bg-blue-50 border-blue-100 text-lg" oninput="calc()">
                    </div>
                    
                    <div class="border-t border-dashed border-slate-200 my-2"></div>
                    
                    <!-- –ü–†–ò–ß–ò–ù–´ –°–ë–û–ï–í -->
                    <div class="space-y-3">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="input-block">
                                <label>–ù–µ—Ç —Ç–æ–≤–∞—Ä–∞ (–ó–∞–∫—É–ø–∫–∏)</label>
                                <input type="number" id="failBuy" value="0" class="text-red-600 bg-red-50/50" oninput="calc()">
                            </div>
                            <div class="input-block">
                                <label>–ù–µ —Å–æ–±—Ä–∞–ª (–°–∫–ª–∞–¥)</label>
                                <input type="number" id="failWhs" value="0" class="text-red-600 bg-red-50/50" oninput="calc()">
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div class="input-block">
                                <label>–ù–µ –¥–æ—Å—Ç–∞–≤–∏–ª (–õ–æ–≥–∏—Å—Ç–∏–∫–∞)</label>
                                <input type="number" id="failLog" value="5" class="text-orange-600 bg-orange-50/50" oninput="calc()">
                            </div>
                            <div class="input-block">
                                <label>–í–æ–∑–≤—Ä–∞—Ç (–ö–ª–∏–µ–Ω—Ç)</label>
                                <input type="number" id="failRet" value="10" class="text-orange-600 bg-orange-50/50" oninput="calc()">
                            </div>
                        </div>
                    </div>
                    
                    <div class="border-t border-slate-100 pt-4 mt-2">
                        <div class="flex justify-between items-end">
                            <span class="font-bold text-slate-600 uppercase text-xs">–ß–∏—Å—Ç—ã–π –§–∞–∫—Ç</span>
                            <span class="text-3xl font-extrabold text-green-600" id="valFact">985</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨: –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
        <div class="xl:col-span-8 space-y-6">
            
            <!-- –ì–õ–ê–í–ù–´–ï KPI (–°–≤–µ—Ç–æ—Ñ–æ—Ä) -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 1: –í—ã—Ä—É—á–∫–∞ -->
                <div class="card border-t-4 border-green-500">
                    <div class="text-xs font-bold text-green-600 uppercase mb-2">–î–µ–Ω—å–≥–∏ –≤ –∫–∞—Å—Å–µ (–§–∞–∫—Ç)</div>
                    <div class="big-num text-slate-800" id="resRevenue">2.46 –º–ª–Ω ‚ÇΩ</div>
                    <div class="sub-text">–ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω –Ω–∞ <span id="resPlanPerc" class="text-slate-800 font-bold">98.5%</span></div>
                </div>

                <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 2: –£–ø—É—â–µ–Ω–Ω–∞—è -->
                <div class="card border-t-4 border-slate-400 bg-slate-50">
                    <div class="text-xs font-bold text-slate-500 uppercase mb-2">–£–ø—É—â–µ–Ω–Ω–∞—è –í—ã—Ä—É—á–∫–∞</div>
                    <div class="big-num text-slate-600" id="resLostRev">0 ‚ÇΩ</div>
                    <div class="sub-text">–¢–æ–≤–∞—Ä –Ω–µ –ø—Ä–æ–¥–∞–Ω (–Ω–µ—Ç —Ç–æ–≤–∞—Ä–∞ / –Ω–µ —Å–æ–±—Ä–∞–ª–∏)</div>
                </div>

                <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 3: –£–±—ã—Ç–∫–∏ -->
                <div class="card border-t-4 border-red-500 bg-red-50">
                    <div class="text-xs font-bold text-red-600 uppercase mb-2">–ü—Ä—è–º—ã–µ –£–±—ã—Ç–∫–∏</div>
                    <div class="big-num text-red-600" id="resDirectLoss">4 500 ‚ÇΩ</div>
                    <div class="sub-text">–õ–æ–≥–∏—Å—Ç–∏–∫–∞ –≤–ø—É—Å—Ç—É—é (–≤–æ–∑–≤—Ä–∞—Ç / –Ω–µ–¥–æ–≤–æ–∑)</div>
                </div>
            </div>

            <!-- –î–ï–¢–ê–õ–ò–ó–ê–¶–ò–Ø (–¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∞–≤–¥—ã) -->
            <div class="card">
                <h2 class="text-slate-700">–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø–æ—Ç–µ—Ä—å</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left border-collapse">
                        <thead>
                            <tr class="border-b-2 border-slate-100 text-xs text-slate-400 uppercase">
                                <th class="py-3 font-bold">–í–∏–Ω–æ–≤–Ω–∏–∫ / –≠—Ç–∞–ø</th>
                                <th class="py-3 text-right">–ö–æ—Ä–æ–±–∞</th>
                                <th class="py-3 text-right">–≠—Ñ—Ñ–µ–∫—Ç (–†—É–±–ª–∏)</th>
                                <th class="py-3 text-right">–¢–∏–ø –ø—Ä–æ–±–ª–µ–º—ã</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody" class="text-slate-700">
                            <!-- JS Generates this -->
                        </tbody>
                        <tfoot class="border-t-2 border-slate-100 bg-slate-50 font-bold">
                            <tr>
                                <td class="py-3 text-slate-500">–ò–¢–û–ì–û –ü–û–¢–ï–†–ò</td>
                                <td class="py-3 text-right" id="totalLossBox">15</td>
                                <td class="py-3 text-right text-red-600" id="totalLossMoney">37 500 ‚ÇΩ</td>
                                <td class="py-3 text-right text-xs uppercase text-slate-400">–°—É–º–º–∞—Ä–Ω–æ</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

            <!-- –ü–û–Ø–°–ù–ï–ù–ò–ï –î–õ–Ø –°–û–ë–°–¢–í–ï–ù–ù–ò–ö–ê -->
            <div class="bg-blue-50 border border-blue-100 rounded-lg p-4 flex gap-4 text-sm text-blue-800">
                <div class="text-2xl">‚ÑπÔ∏è</div>
                <div>
                    <strong class="block mb-1">–ö–∞–∫ —á–∏—Ç–∞—Ç—å —ç—Ç–æ—Ç –æ—Ç—á–µ—Ç:</strong>
                    <ul class="list-disc pl-4 space-y-1 opacity-80">
                        <li><strong>–£–ø—É—â–µ–Ω–Ω–∞—è –≤—ã—Ä—É—á–∫–∞:</strong> –ú—ã –Ω–µ –ø–æ–ª—É—á–∏–ª–∏ —ç—Ç–∏ –¥–µ–Ω—å–≥–∏, –Ω–æ –∏ –Ω–µ –ø–æ—Ç—Ä–∞—Ç–∏–ª–∏ –ª–∏—à–Ω–µ–≥–æ. –≠—Ç–æ "–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π" –º–∏–Ω—É—Å.</li>
                        <li><strong>–ü—Ä—è–º—ã–µ —É–±—ã—Ç–∫–∏:</strong> –≠—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–π "–º–∏–Ω—É—Å –∏–∑ –∫–∞—Ä–º–∞–Ω–∞". –ú—ã –æ–ø–ª–∞—Ç–∏–ª–∏ –¥–æ—Å—Ç–∞–≤–∫—É (300—Ä/–∫–æ—Ä), –Ω–æ —Å–¥–µ–ª–∫–∞ —Å–æ—Ä–≤–∞–ª–∞—Å—å (–≤–æ–∑–≤—Ä–∞—Ç/–Ω–µ–¥–æ–≤–æ–∑).</li>
                        <li><strong>–ù–µ —Å–æ–±—Ä–∞–ª (–°–∫–ª–∞–¥):</strong> –ï—Å–ª–∏ —Å–∫–ª–∞–¥ –Ω–µ —Å–æ–±—Ä–∞–ª, –º—ã —Ç–µ—Ä—è–µ–º –º–∞—Ä–∂—É, –Ω–æ –Ω–µ —Ç—Ä–∞—Ç–∏–º –Ω–∞ –ª–æ–≥–∏—Å—Ç–∏–∫—É (–º–∞—à–∏–Ω–∞ –µ–¥–µ—Ç –±–µ–∑ –∫–æ—Ä–æ–±–∫–∏).</li>
                    </ul>
                </div>
            </div>

        </div>
    </div>

    <script>
        const fmt = new Intl.NumberFormat('ru-RU');
        const rub = (v) => new Intl.NumberFormat('ru-RU', { style: 'currency', currency: 'RUB', maximumFractionDigits: 0 }).format(v);

        function calc() {
            // –í—Ö–æ–¥–Ω—ã–µ
            const price = parseFloat(document.getElementById('price').value) || 0;
            const logCost = parseFloat(document.getElementById('costLog').value) || 0; // –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ 1 –∫–æ—Ä
            const plan = parseInt(document.getElementById('inPlan').value) || 0;

            // –§–∞–∫—Ç–æ—Ä—ã —Å–±–æ–µ–≤
            const f_buy = parseInt(document.getElementById('failBuy').value) || 0; // –ó–∞–∫—É–ø–∫–∏ (OOS)
            const f_whs = parseInt(document.getElementById('failWhs').value) || 0; // –°–∫–ª–∞–¥
            const f_log = parseInt(document.getElementById('failLog').value) || 0; // –õ–æ–≥–∏—Å—Ç–∏–∫–∞
            const f_ret = parseInt(document.getElementById('failRet').value) || 0; // –í–æ–∑–≤—Ä–∞—Ç

            // –ò—Ç–æ–≥–∏
            const totalFail = f_buy + f_whs + f_log + f_ret;
            const fact = plan - totalFail;

            // 1. –£–ø—É—â–µ–Ω–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ (Revenue Opportunity Lost)
            // –≠—Ç–æ –ø–æ–ª–Ω–∞—è —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã –Ω–µ –ø–æ–ª—É—á–∏–ª–∏
            const lostRevenue = (f_buy + f_whs) * price; 
            // *–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –¥–ª—è –õ–æ–≥–∏—Å—Ç–∏–∫–∏ –∏ –í–æ–∑–≤—Ä–∞—Ç–æ–≤ –º—ã –¢–û–ñ–ï —Ç–µ—Ä—è–µ–º –≤—ã—Ä—É—á–∫—É, 
            // –Ω–æ —Ç–∞–º –≤–∞–∂–Ω–µ–µ –ø–æ–¥—Å–≤–µ—Ç–∏—Ç—å —É–±—ã—Ç–æ–∫ –Ω–∞ –ª–æ–≥–∏—Å—Ç–∏–∫–µ. 
            // –í —Ç–∞–±–ª–∏—Ü–µ –ø–æ–∫–∞–∂–µ–º –ø–æ–ª–Ω—É—é –ø–æ—Ç–µ—Ä—é –≤—ã—Ä—É—á–∫–∏, –∞ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ "–£–±—ã—Ç–∫–∏" - –∑–∞—Ç—Ä–∞—Ç—ã.

            // 2. –ü—Ä—è–º—ã–µ —É–±—ã—Ç–∫–∏ (Direct Cost Loss)
            // –ú—ã —Å–∫–∞—Ç–∞–ª–∏ —Ç–æ–≤–∞—Ä –∑—Ä—è. –¢—Ä–∞—Ç—ã –Ω–∞ –ª–æ–≥–∏—Å—Ç–∏–∫—É –±—ã–ª–∏, –≤—ã—Ä—É—á–∫–∏ –Ω–µ—Ç.
            const directLoss = (f_log + f_ret) * logCost; 

            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            document.getElementById('valFact').innerText = fact;
            document.getElementById('resRevenue').innerText = (fact * price / 1000000).toFixed(2) + ' –º–ª–Ω ‚ÇΩ';
            document.getElementById('resPlanPerc').innerText = plan > 0 ? ((fact / plan) * 100).toFixed(1) + '%' : '0%';
            
            document.getElementById('resLostRev').innerText = rub(lostRevenue);
            document.getElementById('resDirectLoss').innerText = rub(directLoss); // –¢–æ–ª—å–∫–æ –ø—Ä—è–º—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –ª–æ–≥–∏—Å—Ç–∏–∫—É

            document.getElementById('totalLossBox').innerText = totalFail;
            document.getElementById('totalLossMoney').innerText = rub(totalFail * price); // –û–±—â–∞—è —Å—É–º–º–∞ –Ω–µ–∑–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–µ–Ω–µ–≥

            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã
            const rows = [
                { name: '–ó–∞–∫—É–ø–∫–∏ (–ù–µ—Ç —Ç–æ–≤–∞—Ä–∞)', val: f_buy, type: '–£–ø—É—â–µ–Ω–Ω–∞—è –í—ã—Ä—É—á–∫–∞', desc: '–ù–µ—Ç –Ω–∞ –æ—Å—Ç–∞—Ç–∫–∞—Ö' },
                { name: '–°–∫–ª–∞–¥ (–ù–µ —Å–æ–±—Ä–∞–ª)', val: f_whs, type: '–£–ø—É—â–µ–Ω–Ω–∞—è –í—ã—Ä—É—á–∫–∞', desc: '–û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏' },
                { name: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞ (–ù–µ –¥–æ—Å—Ç–∞–≤–∏–ª)', val: f_log, type: '–£–±—ã—Ç–æ–∫ + –£–ø—É—â–µ–Ω–Ω–∞—è', desc: '–°—Ä—ã–≤ –¥–æ—Å—Ç–∞–≤–∫–∏' },
                { name: '–ö–ª–∏–µ–Ω—Ç (–í–æ–∑–≤—Ä–∞—Ç)', val: f_ret, type: '–£–±—ã—Ç–æ–∫ + –£–ø—É—â–µ–Ω–Ω–∞—è', desc: '–û—Ç–∫–∞–∑ –ø—Ä–∏ –≤—Ä—É—á–µ–Ω–∏–∏' }
            ].filter(r => r.val > 0);

            const html = rows.map(r => `
                <tr class="border-b border-slate-50 hover:bg-slate-50 transition-colors">
                    <td class="py-3 pl-2">
                        <div class="font-bold text-slate-700">${r.name}</div>
                        <div class="text-xs text-slate-400">${r.desc}</div>
                    </td>
                    <td class="py-3 text-right font-mono font-bold">${r.val}</td>
                    <td class="py-3 text-right">
                        <div class="text-red-600 font-bold">${rub(r.val * price)}</div>
                        ${['–õ–æ–≥–∏—Å—Ç–∏–∫–∞ (–ù–µ –¥–æ—Å—Ç–∞–≤–∏–ª)', '–ö–ª–∏–µ–Ω—Ç (–í–æ–∑–≤—Ä–∞—Ç)'].includes(r.name) 
                            ? `<div class="text-xs text-orange-600 font-bold">–∏–∑ –Ω–∏—Ö —É–±—ã—Ç–æ–∫: ${rub(r.val * logCost)}</div>` 
                            : ''}
                    </td>
                    <td class="py-3 text-right">
                        <span class="badge ${r.type.includes('–£–±—ã—Ç–æ–∫') ? 'bg-red-100 text-red-700' : 'bg-slate-100 text-slate-600'}">
                            ${r.type}
                        </span>
                    </td>
                </tr>
            `).join('');

            document.getElementById('tableBody').innerHTML = html || '<tr><td colspan="4" class="py-8 text-center text-slate-400">–°–±–æ–µ–≤ –Ω–µ—Ç. –ò–¥–µ–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞! üéâ</td></tr>';
        }

        // Init
        calc();
    </script>
</body>
</html>

